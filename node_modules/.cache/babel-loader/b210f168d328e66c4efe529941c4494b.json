{"ast":null,"code":"import _regeneratorRuntime from\"E:\\\\mongoDb\\\\store\\\\baali-store\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _objectSpread from\"E:\\\\mongoDb\\\\store\\\\baali-store\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"E:\\\\mongoDb\\\\store\\\\baali-store\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"E:\\\\mongoDb\\\\store\\\\baali-store\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\mongoDb\\\\store\\\\baali-store\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"E:\\\\mongoDb\\\\store\\\\baali-store\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"E:\\\\mongoDb\\\\store\\\\baali-store\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from'react';import Header from'../../components/Header/Header';import'./style.css';import CartItem from'./CartItem';import*as cartActions from'../../store/actions/cartActions';import*as authActions from'../../store/actions/authActions';import{connect}from'react-redux';import CartPrice from'../../components/CartPrice';var Cart=/*#__PURE__*/function(_Component){_inherits(Cart,_Component);var _super=_createSuper(Cart);function Cart(){var _this;_classCallCheck(this,Cart);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={cartItems:[]};_this.decreaseQuantity=function(e,productId){_this.updateCart(productId,-1);};_this.increaseQuantity=function(e,productId){_this.updateCart(productId,1);};_this.updateCart=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(productId,quantity){var auth,product,response,cartItems;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;auth=_this.props.auth;product=_this.state.cartItems.find(function(item){return item.product===productId;});product={productId:product.product,quantity:parseInt(product.quantity)+parseInt(quantity),newQuantity:quantity,price:product.price,total:parseFloat(product.total)+parseFloat(product.price*quantity)};if(!(product.quantity<=0)){_context.next=6;break;}return _context.abrupt(\"return\");case 6:_context.next=8;return _this.props.updateCart(auth.token,auth.user.userId,product);case 8:response=_context.sent;if(response.ok==1){cartItems=_this.state.cartItems;_this.setState({cartItems:cartItems.map(function(item){return item.product===productId?_objectSpread({},item,{quantity:item.quantity+quantity,total:item.total+item.price*quantity}):item;})});}_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,12]]);}));return function(_x,_x2){return _ref.apply(this,arguments);};}();_this.changeQuantity=function(e,productId){console.log(e.target.value);if(isNaN(e.target.value)){return;}var firstDigit=parseInt(e.target.value.split(\"\")[0]);if(firstDigit===0){return;}//alert(e.target.value);\n_this.updateCart(productId,parseInt(e.target.value));};return _this;}_createClass(Cart,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;if(!this.props.auth.isAuthenticated){this.props.getToken().then(function(result){if(result){var cartItems=_this2.props.getCartItems(_this2.props.auth.token,_this2.props.auth.user.userId);return cartItems;}return[];}).then(function(cartItems){if(cartItems.cart.length>0){console.log(_this2.props.cart);_this2.setState({cartItems:_this2.props.cart.cartItem});}}).catch(function(error){console.log(error);});}else{this.setState({cartItems:this.props.cart.cartItem});}}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(\"div\",{className:\"Content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"CartWrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:\"CartDetails\"},/*#__PURE__*/React.createElement(\"div\",{className:\"CardTitle\"},/*#__PURE__*/React.createElement(\"h3\",null,\"My Cart\")),/*#__PURE__*/React.createElement(\"div\",{className:\"CardBody\"},this.state.cartItems.map(function(product){return/*#__PURE__*/React.createElement(CartItem,{key:product.product,productId:product.product,name:product.name,image:product.image,price:product.price,quantity:product.quantity,total:product.total//name=\"quantity\" \n,changeQuantity:_this3.changeQuantity,increaseQuantity:_this3.increaseQuantity,decreaseQuantity:_this3.decreaseQuantity});}),/*#__PURE__*/React.createElement(\"div\",{className:\"PlaceOrder\"},/*#__PURE__*/React.createElement(\"button\",{className:\"PlaceOrderButton\",onClick:function onClick(){return _this3.props.history.push('/place-order');}},\"Place Order\")))),/*#__PURE__*/React.createElement(CartPrice,null))));}}]);return Cart;}(Component);var mapStateToProps=function mapStateToProps(state){return{auth:state.auth,cart:state.cart};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{getCartItems:function getCartItems(token,userId){return dispatch(cartActions.getCartItems(token,userId));},updateCart:function updateCart(token,userId,product){return dispatch(cartActions.updateCart(token,userId,product));},getToken:function getToken(){return dispatch(authActions.getToken());}};};export default connect(mapStateToProps,mapDispatchToProps)(Cart);","map":{"version":3,"sources":["E:/mongoDb/store/baali-store/client/src/containers/Cart/index.js"],"names":["React","Component","Header","CartItem","cartActions","authActions","connect","CartPrice","Cart","state","cartItems","decreaseQuantity","e","productId","updateCart","increaseQuantity","quantity","auth","props","product","find","item","parseInt","newQuantity","price","total","parseFloat","token","user","userId","response","ok","setState","map","console","log","changeQuantity","target","value","isNaN","firstDigit","split","isAuthenticated","getToken","then","result","getCartItems","cart","length","cartItem","catch","error","name","image","history","push","mapStateToProps","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport Header from '../../components/Header/Header';\r\nimport './style.css';\r\nimport CartItem from './CartItem';\r\nimport * as cartActions from '../../store/actions/cartActions';\r\nimport * as authActions from '../../store/actions/authActions';\r\nimport { connect } from 'react-redux';\r\nimport CartPrice from '../../components/CartPrice';\r\n\r\nclass Cart extends Component{\r\n\r\n    state = {\r\n        cartItems: []\r\n    }\r\n\r\n    decreaseQuantity = (e, productId) => {\r\n        this.updateCart(productId, -1);\r\n    }\r\n\r\n    increaseQuantity = (e, productId) => {\r\n        this.updateCart(productId, 1);\r\n    }\r\n\r\n    updateCart = async (productId, quantity) => {\r\n        try{\r\n            const auth = this.props.auth;\r\n            let product = this.state.cartItems.find(item => item.product === productId);\r\n            product = {\r\n                productId: product.product,\r\n                quantity: parseInt(product.quantity) + parseInt(quantity),\r\n                newQuantity: quantity,\r\n                price: product.price,\r\n                total: parseFloat(product.total) + parseFloat( product.price * quantity )\r\n            }\r\n            if(product.quantity <= 0){\r\n                return;\r\n            }\r\n            const response = await this.props.updateCart(auth.token, auth.user.userId, product);\r\n            if(response.ok == 1){\r\n                const {cartItems} = this.state;\r\n                this.setState({\r\n                    cartItems: cartItems.map(item => item.product === productId ? \r\n                        {...item, quantity: item.quantity + quantity, total: item.total + (item.price * quantity)}: item)\r\n                })\r\n            }\r\n        }catch(error){\r\n            console.log(error);\r\n        }\r\n        \r\n    }\r\n\r\n    changeQuantity = (e, productId) => {\r\n\r\n        console.log(e.target.value);\r\n\r\n        if(isNaN(e.target.value)){\r\n            return;\r\n        }\r\n\r\n        const firstDigit = parseInt(e.target.value.split(\"\")[0]);\r\n        if(firstDigit === 0){\r\n            return;\r\n        }\r\n\r\n        //alert(e.target.value);\r\n\r\n        this.updateCart(productId, parseInt(e.target.value));\r\n    }\r\n\r\n    componentDidMount() {\r\n        if(!this.props.auth.isAuthenticated){\r\n            this.props.getToken()\r\n            .then(result => {\r\n                if(result){\r\n                    const cartItems = this.props.getCartItems(this.props.auth.token, this.props.auth.user.userId);\r\n                    return cartItems;\r\n                }\r\n                return [];\r\n            })\r\n            .then(cartItems => {\r\n                if(cartItems.cart.length > 0){\r\n\r\n                    console.log(this.props.cart)\r\n\r\n                    this.setState({\r\n                        cartItems: this.props.cart.cartItem\r\n                    })\r\n                }\r\n            })\r\n            .catch(error => {\r\n                console.log(error);\r\n            })\r\n        }else{\r\n            this.setState({\r\n                cartItems: this.props.cart.cartItem\r\n            })\r\n        }\r\n    }\r\n\r\n    render (){\r\n\r\n        return (\r\n            <React.Fragment>\r\n                <Header />\r\n                <div className=\"Content\">\r\n                    <div className=\"CartWrapper\">\r\n                        <div className=\"CartDetails\">\r\n                            {/* List cart items */}\r\n                            <div className=\"CardTitle\">\r\n                                <h3>My Cart</h3>\r\n                            </div>\r\n                            <div className=\"CardBody\">\r\n\r\n                                {\r\n                                    this.state.cartItems.map(product => \r\n                                        <CartItem\r\n                                            key={product.product}\r\n                                            productId={product.product}\r\n                                            name={product.name}\r\n                                            image={product.image}\r\n                                            price={product.price}\r\n                                            quantity={product.quantity}\r\n                                            total={product.total}\r\n                                            //name=\"quantity\" \r\n                                            changeQuantity={this.changeQuantity}\r\n                                            increaseQuantity={this.increaseQuantity}\r\n                                            decreaseQuantity={this.decreaseQuantity}\r\n                                    />)\r\n                                }\r\n                                \r\n\r\n                                <div className=\"PlaceOrder\">\r\n                                    <button className=\"PlaceOrderButton\" onClick={() => this.props.history.push('/place-order')}>Place Order</button>\r\n                                </div>\r\n\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        <CartPrice />\r\n\r\n                    </div>\r\n                </div>\r\n            </React.Fragment>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {auth: state.auth,cart: state.cart}\r\n}\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        getCartItems: (token, userId) => dispatch(cartActions.getCartItems(token, userId)),\r\n        updateCart: (token, userId, product) => dispatch(cartActions.updateCart(token, userId, product)),\r\n        getToken: () => dispatch(authActions.getToken())\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Cart);"]},"metadata":{},"sourceType":"module"}